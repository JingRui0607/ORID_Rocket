<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
<form action="Verification.ashx">
    <input type="hidden" name="hiddenToken" id="hiddenToken" >
    <script src="https://www.google.com/recaptcha/api.js?render=6LdGz78UAAAAAD6K2raruEUQnSY11kcEsg2Ng-_X"></script>
    <script>
        grecaptcha.ready(function () {
            grecaptcha.execute('6LdGz78UAAAAAD6K2raruEUQnSY11kcEsg2Ng-_X', { action: 'social' }).then(function (token) {
                //console.log(token);
                document.getElementById("hiddenToken").value = token;
                const tokenId = document.getElementById("hiddenToken").value;
                const xhr = new XMLHttpRequest();
                xhr.open("POST", "verification.ashx");
                // xhr.setRequestHeader("Content-Type", "application/json");
                xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"); // 要用 x-www-form-urlencoded 方式傳送
                //xhr.onload = function () {
                //    console.log('hiddenToken');
                //    const res = this.responseText;
                //    console.log(this.responseText);
                //};
                //xhr.send(`hiddenToken=${tokenId}`);
                        
            });
        });
    </script>
    <input type="submit" class="form__btn">GO!</input>
</form>
</body>
</html>